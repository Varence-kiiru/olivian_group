{% extends "admin/base_site.html" %}
{% load i18n %}

{% block title %}{{ title }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<div class="module">
    <h2>{{ title }}</h2>

    <div class="stats-grid">
        <div class="stat-card">
            <h3>{% trans 'Total Rooms' %}</h3>
            <p class="stat-number">{{ total_rooms }}</p>
        </div>
        <div class="stat-card">
            <h3>{% trans 'Total Messages' %}</h3>
            <p class="stat-number">{{ total_messages }}</p>
        </div>
        <div class="stat-card">
            <h3>{% trans 'Active Users' %}</h3>
            <p class="stat-number">{{ total_users_with_activity }}</p>
        </div>
        <div class="stat-card">
            <h3>{% trans 'Total Reactions' %}</h3>
            <p class="stat-number">{{ total_reactions }}</p>
        </div>
        <div class="stat-card">
            <h3>{% trans 'Messages with Attachments' %}</h3>
            <p class="stat-number">{{ messages_with_attachments }}</p>
        </div>
        <div class="stat-card">
            <h3>{% trans 'Total Attachment Size' %}</h3>
            <p class="stat-number">{{ total_attachments_size }}</p>
        </div>
    </div>

    <h3>{% trans 'Clear Chat Data' %}</h3>
    <p>{% trans 'Warning: These operations cannot be undone. Please proceed with caution.' %}</p>

    <form method="post">
        {% csrf_token %}
        <div class="clear-actions">
            <div class="action-group">
                <button type="submit" name="clear_action" value="messages" class="btn btn-warning">
                    {% trans 'Clear All Messages' %}
                </button>
                <span class="action-desc">{% trans 'Delete all messages and related data' %}</span>
            </div>

            <div class="action-group">
                <button type="submit" name="clear_action" value="attachments" class="btn btn-warning">
                    {% trans 'Clear All Attachments' %}
                </button>
                <span class="action-desc">{% trans 'Delete all file attachments' %}</span>
            </div>

            <div class="action-group">
                <button type="submit" name="clear_action" value="activity" class="btn btn-warning">
                    {% trans 'Clear User Activity' %}
                </button>
                <span class="action-desc">{% trans 'Delete all user online/typing status data' %}</span>
            </div>

            <div class="action-group">
                <button type="submit" name="clear_action" value="all" class="btn btn-danger">
                    {% trans 'Clear Everything' %}
                </button>
                <span class="action-desc">{% trans 'Delete all chat data (messages, attachments, activity)' %}</span>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block extrastyle %}
<style>
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.stat-card {
    background: #f8f8f8;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    border: 1px solid #ddd;
}

.stat-card h3 {
    margin: 0 0 10px 0;
    color: #666;
    font-size: 14px;
    font-weight: normal;
}

.stat-number {
    font-size: 36px;
    font-weight: bold;
    color: #2c3e50;
    margin: 0;
}

.clear-actions {
    margin-top: 30px;
}

.action-group {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    padding: 15px;
    background: #fdfdfd;
    border: 1px solid #e0e0e0;
    border-radius: 6px;
}

.action-group button {
    margin-right: 20px;
    padding: 8px 16px;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    font-weight: bold;
}

.btn-warning {
    background: #f39c12;
    color: white;
}

.btn-warning:hover {
    background: #e67e22;
}

.btn-danger {
    background: #e74c3c;
    color: white;
}

.btn-danger:hover {
    background: #c0392b;
}

.action-desc {
    color: #666;
    font-size: 14px;
}

.breadcrumbs {
    margin-bottom: 20px;
}
</style>
{% endblock %}
