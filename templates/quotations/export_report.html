<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Quotations Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .summary { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #4e73df; color: white; }
        .status-draft { background: #6c757d; }
        .status-sent { background: #17a2b8; }
        .status-accepted { background: #28a745; }
        .status-rejected { background: #dc3545; }
        .status-expired { background: #6c757d; }
        .status-converted { background: #6f42c1; }
        .status { color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px; }
        .text-right { text-align: right; }
        .footer { margin-top: 30px; text-align: center; font-size: 12px; color: #666; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Quotations Export Report</h1>
        <p>Generated on {{ export_date|date:"F d, Y g:i A" }}</p>
    </div>

    <div class="summary">
        <h3>Summary</h3>
        <p><strong>Total Quotations:</strong> {{ total_count }}</p>
        <p><strong>Total Value:</strong> KES {{ total_value|floatformat:0 }}</p>
        <p><strong>Average Value:</strong> KES {% if total_count > 0 %}{% widthratio total_value total_count 1 %}{% else %}0{% endif %}</p>
    </div>

    <table>
        <thead>
            <tr>
                <th>Quotation #</th>
                <th>Customer</th>
                <th>Email</th>
                <th>System Type</th>
                <th>Capacity (kW)</th>
                <th>Amount (KES)</th>
                <th>Status</th>
                <th>Created</th>
                <th>Valid Until</th>
            </tr>
        </thead>
        <tbody>
            {% for quotation in quotations %}
            <tr>
                <td>{{ quotation.quotation_number }}</td>
                <td>{{ quotation.customer.name }}</td>
                <td>{{ quotation.customer.email }}</td>
                <td>{{ quotation.get_system_type_display }}</td>
                <td class="text-right">{{ quotation.system_capacity }}</td>
                <td class="text-right">{{ quotation.total_amount|floatformat:0 }}</td>
                <td>
                    <span class="status status-{{ quotation.status }}">
                        {{ quotation.get_status_display }}
                    </span>
                </td>
                <td>{{ quotation.created_at|date:"M d, Y" }}</td>
                <td>{{ quotation.valid_until|date:"M d, Y"|default:"-" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="footer">
        <p>Report generated by Olivian Group Management System</p>
    </div>
</body>
</html>
